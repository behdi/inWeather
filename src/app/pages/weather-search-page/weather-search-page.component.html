<div class="container">
  <div class="card">
    <nz-select
      id="city-selector"
      nzShowSearch
      nzServerSearch
      [nzPlaceHolder]="'weatherSearchPage.searchBoxPlaceholder' | transloco"
      [formControl]="searchInputCtrl"
      [nzShowArrow]="true"
      [nzDropdownClassName]="'weather-search-options'"
      [nzSuffixIcon]="suffixIcon"
      [nzStatus]="hasError ? 'error' : ''"
      (nzOnSearch)="onSearchChange($event)"
    >
      <ng-container *ngIf="optionList$ | async as options">
        <nz-option
          *ngFor="let opt of options"
          [nzLabel]="opt.text"
          [nzValue]="opt.value"
        ></nz-option>
      </ng-container>
      <nz-option *ngIf="isLoading" nzDisabled nzCustomContent>
        <span nz-icon nzType="loading" class="loading-icon"></span>
        {{ "general.loading" | transloco }}
      </nz-option>
      <ng-template #suffixIcon>
        <div class="search-icon">
          <span nz-icon nzType="search"></span>
        </div>
      </ng-template>
    </nz-select>

    <div
      class="weather-data"
      *ngIf="weatherData$ | async as weatherData; else noData"
    >
      <p class="weather-data-title">
        {{
          "weatherSearchPage.weatherData.generalInfo"
            | transloco : { place: weatherData.name }
        }}
      </p>

      <p class="weather-data-temp">{{ weatherData.main.temp }} Â°C</p>
      <p *ngIf="weatherData.weather[0] as condition" class="weather-condition">
        <img
          class="weather-condition-icon"
          [src]="'https://openweathermap.org/img/wn/' + condition.icon + '.png'"
          [alt]="condition.description"
        />
        {{ condition.main }}
      </p>
      <p class="weather-data-humidity">
        {{ "weatherSearchPage.weatherData.humidity" | transloco }}
        {{ weatherData.main.humidity }}%
      </p>
      <p class="weather-data-wind-speed">
        {{ "weatherSearchPage.weatherData.windSpeed" | transloco }}
        {{ weatherData.wind.speed }} km/hr
      </p>
    </div>

    <ng-template #noData>
      <div class="no-data-notice">
        <span
          nz-icon
          nzType="warning"
          nzTheme="twotone"
          [nzTwotoneColor]="'#faad14'"
        ></span>
        <p>
          {{ "weatherSearchPage.noData" | transloco }}
        </p>
      </div>
    </ng-template>
  </div>
</div>
